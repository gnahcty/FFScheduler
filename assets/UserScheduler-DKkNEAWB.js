import{Y as x,a2 as L,C as K,o as l,c as r,B as Y,J as Q,l as B,D as Z,a3 as ee,a4 as te,j as h,g as i,m as H,X as k,a as t,t as p,F as D,h as I,i as S,s as R,N as P,k as T,e as w,b as y,a5 as ne,a6 as se}from"./index-IOWfBMct.js";import{m as ae,v as U,_ as oe}from"./FieldSet-DpCvs9f7.js";import{c as O,g as le,f as b,s as re}from"./format-9e0X1DaC.js";import{u as A}from"./useAxios-DkOjNQ3S.js";import{e as V}from"./eachDayOfInterval-DHPlm0-0.js";import"./index-BC8PiArN.js";function ie(s,a){const e=x(s);return isNaN(a)?O(s,NaN):(a&&e.setDate(e.getDate()+a),e)}function de(s,a){const e=x(s);if(isNaN(a))return O(s,NaN);if(!a)return e;const o=e.getDate(),n=O(s,e.getTime());n.setMonth(e.getMonth()+a+1,0);const d=n.getDate();return o>=d?n:(e.setFullYear(n.getFullYear(),n.getMonth(),o),e)}function z(s,a){const e=a*7;return ie(s,e)}function ce(s){return O(s,Date.now())}function ue(s){const a=x(s),e=a.getMonth();return a.setFullYear(a.getFullYear(),e+1,0),a.setHours(23,59,59,999),a}function pe(s){const a=x(s);return a.setDate(1),a.setHours(0,0,0,0),a}function ve(s,a){var f,m,_,g;const e=le(),o=(a==null?void 0:a.weekStartsOn)??((m=(f=a==null?void 0:a.locale)==null?void 0:f.options)==null?void 0:m.weekStartsOn)??e.weekStartsOn??((g=(_=e.locale)==null?void 0:_.options)==null?void 0:g.weekStartsOn)??0,n=x(s),d=n.getDay(),v=(d<o?-7:0)+6-(d-o);return n.setDate(n.getDate()+v),n.setHours(23,59,59,999),n}function fe(s){return x(s).getDate()}function _e(s){return x(s).getDay()}function ge(s){return x(s).getFullYear()}function j(s){return L(s,ce(s))}function G(s,a){const e=+x(s),[o,n]=[+x(a.start),+x(a.end)].sort((d,v)=>d-v);return e>=o&&e<=n}var me={root:function(a){var e=a.props;return{justifyContent:e.layout==="horizontal"?e.align==="center"||e.align===null?"center":e.align==="left"?"flex-start":e.align==="right"?"flex-end":null:null,alignItems:e.layout==="vertical"?e.align==="center"||e.align===null?"center":e.align==="top"?"flex-start":e.align==="bottom"?"flex-end":null:null}}},he={root:function(a){var e=a.props;return["p-divider p-component","p-divider-"+e.layout,"p-divider-"+e.type,{"p-divider-left":e.layout==="horizontal"&&(!e.align||e.align==="left")},{"p-divider-center":e.layout==="horizontal"&&e.align==="center"},{"p-divider-right":e.layout==="horizontal"&&e.align==="right"},{"p-divider-top":e.layout==="vertical"&&e.align==="top"},{"p-divider-center":e.layout==="vertical"&&(!e.align||e.align==="center")},{"p-divider-bottom":e.layout==="vertical"&&e.align==="bottom"}]},content:"p-divider-content"},xe=K.extend({name:"divider",classes:he,inlineStyles:me}),ye={name:"BaseDivider",extends:Z,props:{align:{type:String,default:null},layout:{type:String,default:"horizontal"},type:{type:String,default:"solid"}},style:xe,provide:function(){return{$parentInstance:this}}},J={name:"Divider",extends:ye,inheritAttrs:!1},De=["aria-orientation"];function we(s,a,e,o,n,d){return l(),r("div",Y({class:s.cx("root"),style:s.sx("root"),role:"separator","aria-orientation":s.layout},s.ptmi("root")),[s.$slots.default?(l(),r("div",Y({key:0,class:s.cx("content")},s.ptm("content")),[Q(s.$slots,"default")],16)):B("",!0)],16,De)}J.render=we;const $e={class:"truncate text-xs leading-tight"},be={class:"truncate text-sm leading-tight"},ke={class:"truncate text-xs leading-tight"},Se={key:1,class:"flex gap-3 lg:hidden"},Me={class:"flex flex-col items-center text-sm"},Ce=t("span",null,"|",-1),Oe={class:"truncate"},Fe={class:"truncate"},X={__name:"EventChips",props:ee({showHidden:{type:Boolean,default:!1}},{list:{},listModifiers:{}}),emits:["update:list"],setup(s){var m;const a=s,e=te(s,"list"),o=ae((m=e.value)==null?void 0:m._id),n=e.value.screening.film,d=b(e.value.screening.time,"HH:mm"),v=b(e.value.screening.endTime,"HH:mm"),f=h(()=>a.showHidden?o.isHidden.value:!o.isHidden.value);return(_,g)=>(l(),r(D,null,[i(o).isHidden.value?B("",!0):H((l(),r("div",{key:0,class:k(["mt-1 hidden cursor-pointer overflow-hidden rounded-lg px-2 py-1 lg:block",i(o).chipStyle.value]),onClick:g[0]||(g[0]=M=>i(o).hide())},[t("p",$e,p(i(d))+" - "+p(i(v)),1),t("p",be,p(i(n).CName),1),t("p",ke,p(i(n).EName),1)],2)),[[i(U),[()=>i(o).lock(),{modifiers:{stop:!0}}]]]),f.value?(l(),r("div",Se,[t("div",Me,[t("span",null,p(i(d)),1),Ce,t("span",null,p(i(v)),1)]),H((l(),r("div",{class:k(["mt-1 flex-auto cursor-pointer select-none overflow-hidden rounded-lg border px-2 py-1",i(o).chipStyle.value]),onClick:g[1]||(g[1]=M=>i(o).hide())},[t("p",Oe,p(i(n).CName),1),t("p",Fe,p(i(n).EName),1)],2)),[[i(U),[()=>i(o).lock(),{modifiers:{stop:!0}}]]])])):B("",!0)],64))}},Ne={class:"mx-auto mt-5 flex justify-center overflow-auto py-4 sm:justify-center sm:px-2 md:mx-12"},je=["onClick"],Be={class:"flex flex-col items-center px-4 py-4 text-center"},He={class:"text-sm"},Le={class:"mt-3"},Re=["onClick"],Te={class:"text-sm"},Ee={class:"flex w-full items-center justify-center gap-5 font-bold text-white"},We={class:"text-lg"},Ye={class:"flex flex-col"},Ue={class:"flex flex-wrap px-5 sm:mt-10"},ze={class:"flex flex-auto flex-col gap-1 rounded p-3"},Ie={class:"w-full sm:w-64"},Pe=t("div",{class:"text-center font-bold underline underline-offset-2 opacity-50"}," 本日已刪除場次 ",-1),Ae={class:"mt-3 min-h-32 rounded-lg border border-dashed px-2 py-3"},Ve={__name:"CalendarForMobile",setup(s){const a=I(),e=S(null),o=S([]),n=S(new Date),{getFFDateRange:d}=A(),v=R(),f=c=>h(()=>G(c,{start:new Date(e.value.start),end:new Date(e.value.end)})||L(c,new Date(e.value.start))),m=h(()=>re(n.value,{weekStartsOn:1})),_=h(()=>ve(n.value,{weekStartsOn:1})),g=h(()=>b(n.value,"MMMM yyyy")),M=h(()=>V({start:m.value,end:_.value}).map(c=>({day:b(c,"EEE"),date:b(c,"dd"),dateString:b(c,"yyyy-MM-dd")}))),C=()=>{n.value=z(n.value,1)},F=()=>{n.value=z(n.value,-1)};return P(()=>n.value,()=>{o.value=v.getListByDate(n.value)}),T(async()=>{e.value=await d(),n.value=new Date(e.value.start),o.value=v.getListByDate(n.value),a.isLoading=!1}),(c,yt)=>{const E=ne,W=X,q=J;return l(),r(D,null,[t("div",Ne,[(l(!0),r(D,null,w(M.value,u=>(l(),r("div",{key:u.dateString},[t("div",{class:k(["hidden justify-center sm:mx-1 sm:flex sm:w-16 sm:cursor-pointer sm:rounded-lg",{" border border-primary-700 font-bold ":n.value.getDate()===new Date(u.dateString).getDate(),"text-primary-500":f(u.dateString),"text-primary-50":!f(u.dateString)}]),onClick:$=>n.value=new Date(u.dateString)},[t("div",Be,[t("p",He,p(u.day),1),t("p",Le,p(u.date),1)])],10,je),t("div",{class:k(["mx-1 flex flex-col justify-center gap-3 text-center sm:hidden",{"text-primary-500":f(u.dateString),"text-primary-50":!f(u.dateString)}]),onClick:$=>n.value=new Date(u.dateString)},[t("p",Te,p(u.day),1),t("p",{class:k(["flex h-10 w-10 cursor-pointer items-center justify-center rounded-full",{"border border-primary-600 font-bold ":n.value.getDate()===new Date(u.dateString).getDate()}])},p(u.date),3)],10,Re)]))),128))]),t("div",Ee,[y(E,{onClick:F,class:"px-4 py-2",icon:"pi pi-angle-left",text:"",rounded:""}),t("div",We,p(g.value),1),y(E,{onClick:C,class:"px-4 py-2",icon:"pi pi-angle-right",text:"",rounded:""})]),t("div",Ye,[t("div",Ue,[t("div",ze,[(l(!0),r(D,null,w(o.value,(u,$)=>(l(),r("div",{key:u._id},[y(W,{list:o.value[$],"onUpdate:list":N=>o.value[$]=N},null,8,["list","onUpdate:list"])]))),128))]),y(q,{class:"sm:hidden"}),t("div",Ie,[Pe,t("div",Ae,[(l(!0),r(D,null,w(o.value,(u,$)=>(l(),r("div",{key:u._id},[y(W,{list:o.value[$],"onUpdate:list":N=>o.value[$]=N,showHidden:""},null,8,["list","onUpdate:list"])]))),128))])])])])],64)}}},Ge={class:"relative h-full min-h-32 border-b border-r border-stone-700 px-2 py-2"},Je={__name:"DateBlock",props:{date:{type:Object,default:null},dateRange:{type:Object,default:null}},setup(s){const{getListByDate:a}=R(),e=s,o=S([]),n=h(()=>{var d;return(d=e.dateRange)!=null&&d.value?G(e.date,{start:new Date(e.dateRange.value.start),end:new Date(e.dateRange.value.end)})||L(e.date,new Date(e.dateRange.value.start)):!1});return P(()=>e.date,()=>{o.value=a(e.date)}),T(async()=>{o.value=a(e.date)}),(d,v)=>{const f=X;return l(),r("div",Ge,[t("div",{class:k(["inline-flex h-6 w-6 cursor-pointer items-center justify-center rounded-full text-center leading-none transition duration-100 ease-in-out",{"text-primary-500 underline underline-offset-4":i(j)(e.date),"text-stone-200":n.value&&!i(j)(e.date),"text-stone-600":!i(j)(e.date)&&!n.value}])},p(i(fe)(e.date)),3),(l(!0),r(D,null,w(o.value,(m,_)=>(l(),r("div",{key:m._id},[y(f,{list:o.value[_],"onUpdate:list":g=>o.value[_]=g},null,8,["list","onUpdate:list"])]))),128))])}}},Xe={class:"relative mt-10 overflow-hidden rounded-lg border border-stone-600"},qe={class:"flex items-center justify-between px-6 py-2"},Ke={class:"text-lg font-bold"},Qe={class:"ml-1 text-lg font-bold"},Ze={class:"flex items-center rounded-lg px-1",style:{"padding-top":"2px"}},et=t("span",{class:"pi pi-angle-left"},null,-1),tt=[et],nt=t("span",{class:"pi pi-angle-right"},null,-1),st=[nt],at={class:"-mx-1 -mb-1 grid grid-cols-7 border-t border-stone-600"},ot={class:"absolute grid w-full grid-cols-7"},lt={class:"pl-2 text-center text-sm font-bold uppercase tracking-wide text-primary-800"},rt=t("div",{class:"h-full min-h-32 border-b border-r border-stone-600"},null,-1),it=[rt],dt={__name:"CalendarForPC",setup(s){const a=I(),{getFFDateRange:e}=A(),o=S(null),n=S(new Date),d=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],v=h(()=>pe(n.value)),f=h(()=>ue(n.value)),m=h(()=>V({start:v.value,end:f.value})),_=h(()=>(_e(v.value)+6)%7);function g(M){n.value=de(n.value,M)}return T(async()=>{o.value=await e(),n.value=new Date(o.value.start),a.isLoading=!1}),(M,C)=>{const F=Je;return l(),r("div",Xe,[t("div",qe,[t("div",null,[t("span",Ke,p(i(b)(n.value,"MMMM")),1),t("span",Qe,p(i(ge)(n.value)),1)]),t("div",Ze,[t("button",{class:"inline-flex cursor-pointer items-center rounded-lg p-1 leading-none transition duration-100 ease-in-out hover:bg-gray-200",onClick:C[0]||(C[0]=c=>g(-1))},tt),t("button",{class:"inline-flex cursor-pointer items-center rounded-lg p-1 leading-none transition duration-100 ease-in-out hover:bg-gray-200",onClick:C[1]||(C[1]=c=>g(1))},st)])]),t("div",at,[t("div",ot,[(l(),r(D,null,w(d,c=>t("div",{key:c,class:"h-8 pt-[10px]"},[t("div",lt,p(c),1)])),64))]),(l(!0),r(D,null,w(_.value,c=>(l(),r("div",{key:c},it))),128)),(l(!0),r(D,null,w(m.value,c=>(l(),r("div",{key:c.getDate()},[y(F,{date:c,dateRange:o.value},null,8,["date","dateRange"])]))),128))])])}}},ct={class:"min-h-screen w-full bg-stone-900 py-12 text-primary-600 lg:h-screen"},ut={class:"no-scrollbar mx-auto hidden h-full w-screen lg:flex"},pt={class:"no-scrollbar h-full w-full overflow-auto px-10"},vt={class:"flex w-full flex-1 items-center justify-between px-2 lg:pt-8"},ft=t("div",{class:"text-7xl uppercase"},"scheduler",-1),_t={class:"flex gap-5 text-xl"},gt={class:"pi pi-info-circle cursor-pointer hover:text-stone-300"},mt={class:"no-scrollbar flex-auto overflow-auto"},ht={class:"lg:hidden"},xt=`點擊場次以刪除
 長按場次以鎖定`,Mt={__name:"UserScheduler",setup(s){const a=R(),e=S(!1);return(o,n)=>{const d=dt,v=oe,f=Ve,m=se("tooltip");return l(),r("div",ct,[t("div",ut,[t("div",pt,[t("div",vt,[ft,t("div",_t,[H(t("div",gt,null,512),[[m,xt,void 0,{left:!0}]]),t("div",{class:"pi pi-list cursor-pointer hover:text-stone-300",onClick:n[0]||(n[0]=_=>e.value=!e.value)})])]),y(d)]),t("div",{id:"list",class:k(["no-scrollbar flex h-full flex-col justify-between pr-5 transition-all duration-300",{"w-0":!e.value,"w-1/2":e.value}])},[t("div",mt,[(l(!0),r(D,null,w(i(a).listByFilm,_=>(l(),r("div",{key:_.CName},[y(v,{film:_},null,8,["film"])]))),128))])],2)]),t("div",ht,[y(f)])])}}};export{Mt as default};
